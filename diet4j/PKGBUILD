pkgname=$(basename $(pwd))
pkgver=0.11
pkgrel=3
pkgdesc='diet4j Java module management'
arch=('any')
url="http://jdiet.org/"
license=('Apache')
makedepends=('maven' 'jdk8-openjdk' )
depends=('java-runtime=8')
# source=("git+https://github.com/diet4j/diet4j.git#tag=diet4j-${pkgver}")
source=("git+https://github.com/diet4j/diet4j.git")
sha512sums=('SKIP')

build() {
    cd ${pkgname}
    mvn package install ${MVN_OPTS}
}

package() {
    installOne 'diet4j-cmdline'
    installOne 'diet4j-core'
    installOne 'diet4j-inclasspath'
    installOne 'diet4j-tomcat'
    installOne 'diet4j-status'
    install -m755 -D ${srcdir}/diet4j/diet4j-cmdline/bin/diet4j ${pkgdir}/usr/bin/diet4j
}

installOne() {
    local name=$1 
    install -m644 -D ${srcdir}/diet4j/${name}/target/${name}-${pkgver}.jar ${pkgdir}/usr/lib/java/org/diet4j/${name}/${pkgver}/${name}-${pkgver}.jar
}
