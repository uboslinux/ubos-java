maintainer="http://indiecomputing.com/"
pkgname=$(basename $(pwd))
_name='protobuf-java'
_groupId='com.google.protobuf'
pkgver=3.11.1
pkgrel=1
pkgdesc='Protocol Buffers [Core]'
arch=('any')
url="https://developers.google.com/protocol-buffers/"
license=("custom:${pkgname}")
depends=(
    'java-environment'
)
_rooturl="http://search.maven.org/remotecontent?filepath=com/google/protobuf"
_modules=(
    'protobuf-java'
    'protobuf-java-util'
)
options=('!strip')
noextract=("${source[@]##*/}")
releasepage=('https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22com.google.protobuf%22')

source=('https://raw.githubusercontent.com/google/protobuf/master/LICENSE')
for _m in "${_modules[@]}"; do \
    source+=("${_rooturl}/${_m}/${pkgver}/${_m}-${pkgver}.jar"); \
    source+=("${_rooturl}/${_m}/${pkgver}/${_m}-${pkgver}.pom"); \
done

sha512sums=('83630af6c999eed50aa04cc90b22dcba4e28946d000a61947859246a390ce4e1b5fa1c4f3063ab0772cbcbfc943f0f0991d97a665ee25aaf12de342ac1afd3a5'
            '8bfedb8fbc46a1f9d4408236a50d53cb71750a0680f351e26c4c238c15803ee7c180fad462e885129c60d3335f98a947b170a32704265044312b1ec5daa0003a'
            '550a3843ef83893fb6fa5f4e61b0936091b2b2cf7db03ebc02125b1a5951e39b6e33760c507fedb32fdd3505573dfaf8a6d32051a81f4e2f4cb3d0eae87d7d53'
            '50d14ac366550480749ef05db54150e4aa5f3398603868f777e92a29672927e9c540c4d8ade8ff60b238259800fa921e28b97dafd37c6e7f9e98cafddcd13323'
            'a3a4d38f4fc7dca5966230cc15f203ddae3bc24b7b39dbbc910ceaa0c0dbd2eff70845e08ba46785fedfe2e41f310a0264c7dd5193c09584288b3b9dbdf17f7b')

package() {
    cd "${srcdir}"

    install -m644 -D LICENSE -t ${pkgdir}/usr/share/licenses/${pkgname}

    for _m in "${_modules[@]}"; do
        install -D -m644 "${_m}-${pkgver}.jar" "${pkgdir}/usr/lib/java/${_groupId//.//}/${_m}/${pkgver}/${_m}-${pkgver}.jar"
        install -D -m644 "${_m}-${pkgver}.pom" "${pkgdir}/usr/lib/java/${_groupId//.//}/${_m}/${pkgver}/${_m}-${pkgver}.pom"
    done
}
