maintainer="http://indiecomputing.com/"
pkgname=$(basename $(pwd))
_name='protobuf-java'
_groupId='com.google.protobuf'
pkgver=3.17.0
pkgrel=1
pkgdesc='Protocol Buffers [Core]'
arch=('any')
url="https://developers.google.com/protocol-buffers/"
license=("custom:${pkgname}")
depends=(
    'java-environment'
)
_rooturl="http://search.maven.org/remotecontent?filepath=com/google/protobuf"
_modules=(
    'protobuf-java'
    'protobuf-java-util'
)
options=('!strip')
noextract=("${source[@]##*/}")
releasepage=('https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22com.google.protobuf%22')

source=('https://raw.githubusercontent.com/google/protobuf/master/LICENSE')
for _m in "${_modules[@]}"; do \
    source+=("${_rooturl}/${_m}/${pkgver}/${_m}-${pkgver}.jar"); \
    source+=("${_rooturl}/${_m}/${pkgver}/${_m}-${pkgver}.pom"); \
done

sha512sums=('83630af6c999eed50aa04cc90b22dcba4e28946d000a61947859246a390ce4e1b5fa1c4f3063ab0772cbcbfc943f0f0991d97a665ee25aaf12de342ac1afd3a5'
            'fa27fe5a69e47e541a39eeb27a4decee12926140ddf507812250a12bd97a0857da97b3c942b308069c9c80783d56b730e451443ffa720a699fcf4361f0f67362'
            'dd9048b1760b686dc2d95ba5d6d693441f9543a7848caf962c9990f672a3d75aaa6b682bf7adf261b7338c3e9c1385aefa6016045972427e10e9102231ae865b'
            'd11a8b2e327c058dc4bd8b0952e9a99012a0df157f1ac5f9f9b39359550ac1ed7313b245d71c7415e61afac0c5612f1a4b8d6022fb569b51bea4ca4cd95521c0'
            '564d32af865fa7560d20188ba68df54e4f5abb45d89fa0b941728f526bbc2903bc37f97101101b47ef72b74d99ab7c35c6de78cc85c793dd148c183524cbe345')

package() {
    cd "${srcdir}"

    install -m644 -D LICENSE -t ${pkgdir}/usr/share/licenses/${pkgname}

    for _m in "${_modules[@]}"; do
        install -D -m644 "${_m}-${pkgver}.jar" "${pkgdir}/usr/lib/java/${_groupId//.//}/${_m}/${pkgver}/${_m}-${pkgver}.jar"
        install -D -m644 "${_m}-${pkgver}.pom" "${pkgdir}/usr/lib/java/${_groupId//.//}/${_m}/${pkgver}/${_m}-${pkgver}.pom"
    done
}
